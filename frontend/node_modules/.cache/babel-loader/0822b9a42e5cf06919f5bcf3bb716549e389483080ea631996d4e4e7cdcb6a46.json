{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\itsmu\\\\Downloads\\\\twiller_complete_project\\\\frontend\\\\src\\\\components\\\\PostComposer.jsx\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState, useEffect, useContext } from \"react\";\nimport API from \"../api\";\nimport NotificationContext from \"../notificationContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction highlightCaption(text) {\n  // Highlight hashtags and @mentions in blue\n  const regex = /([#@][\\w]+)/g;\n  const parts = text.split(regex);\n  return parts.map((part, i) => regex.test(part) ? /*#__PURE__*/_jsxDEV(\"span\", {\n    className: \"text-blue-500 font-semibold\",\n    children: part\n  }, i, false, {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 9\n  }, this) : part);\n}\nexport default function PostComposer({\n  onPosted\n}) {\n  _s();\n  const {\n    enabled: notificationsEnabled\n  } = useContext(NotificationContext);\n  const [caption, setCaption] = useState(\"\");\n  const [mediaFiles, setMediaFiles] = useState([]); // Array of File\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const fileInputRef = useRef();\n  const [dragActive, setDragActive] = useState(false);\n  const [user, setUser] = useState(null);\n  const [todayCount, setTodayCount] = useState(0);\n  const [quotaInfo, setQuotaInfo] = useState({\n    allowed: 1,\n    remaining: 1,\n    reason: \"\"\n  });\n  useEffect(() => {\n    async function load() {\n      try {\n        var _u$subscription, _planMap$plan;\n        const res = await API.get(\"/auth/me\");\n        const u = res.data.user;\n        setUser(u);\n        // fetch tweets and compute today's count\n        const tweetsRes = await API.get(\"/tweets\");\n        const all = tweetsRes.data || [];\n        const myId = u === null || u === void 0 ? void 0 : u._id;\n        const today = new Date();\n        const istToday = new Date(today.toLocaleString(\"en-US\", {\n          timeZone: \"Asia/Kolkata\"\n        }));\n        const start = new Date(istToday.getFullYear(), istToday.getMonth(), istToday.getDate(), 0, 0, 0);\n        const end = new Date(istToday.getFullYear(), istToday.getMonth(), istToday.getDate(), 23, 59, 59);\n        const used = all.filter(t => {\n          var _t$user;\n          return ((_t$user = t.user) === null || _t$user === void 0 ? void 0 : _t$user._id) === myId && new Date(t.createdAt) >= start && new Date(t.createdAt) <= end;\n        }).length;\n        setTodayCount(used);\n\n        // compute allowed posts by subscription\n        const plan = (u === null || u === void 0 ? void 0 : (_u$subscription = u.subscription) === null || _u$subscription === void 0 ? void 0 : _u$subscription.plan) || \"free\";\n        const planMap = {\n          free: 1,\n          bronze: 3,\n          silver: 5,\n          gold: Infinity\n        };\n        let allowedByPlan = (_planMap$plan = planMap[plan]) !== null && _planMap$plan !== void 0 ? _planMap$plan : 1;\n\n        // follow-based allowances\n        const follows = ((u === null || u === void 0 ? void 0 : u.follows) || []).length;\n        let allowedByFollows = 0;\n        if (follows === 0) {\n          allowedByFollows = 1; // limited to 1 but time-window enforced on post\n        } else if (follows === 2) {\n          allowedByFollows = 2;\n        } else if (follows > 10) {\n          allowedByFollows = Infinity;\n        }\n        const allowed = allowedByFollows === 0 ? allowedByPlan : Math.max(allowedByPlan, allowedByFollows);\n        const remaining = allowed === Infinity ? Infinity : Math.max(0, allowed - used);\n        setQuotaInfo({\n          allowed,\n          remaining,\n          reason: \"\"\n        });\n      } catch (e) {\n        // ignore\n      }\n    }\n    load();\n  }, []);\n  function handleUploadClick() {\n    fileInputRef.current.click();\n  }\n  function handleFileChange(e) {\n    let files = Array.from(e.target.files);\n    validateAndSetFiles(files);\n  }\n  function handleDrop(e) {\n    e.preventDefault();\n    setDragActive(false);\n    let files = Array.from(e.dataTransfer.files);\n    validateAndSetFiles(files);\n  }\n  function handleDragOver(e) {\n    e.preventDefault();\n    setDragActive(true);\n  }\n  function handleDragLeave(e) {\n    e.preventDefault();\n    setDragActive(false);\n  }\n  function validateAndSetFiles(files) {\n    setError(\"\");\n    let images = files.filter(f => f.type.startsWith(\"image\"));\n    let videos = files.filter(f => f.type.startsWith(\"video\"));\n    if (videos.length > 1 || videos.length && images.length) {\n      setError(\"You can upload up to 4 images or 1 video only.\");\n      return;\n    }\n    if (images.length > 4) {\n      setError(\"Maximum 4 images allowed.\");\n      return;\n    }\n    for (let img of images) {\n      if (img.size > 5 * 1024 * 1024) {\n        setError(\"Each image must be ≤ 5MB.\");\n        return;\n      }\n    }\n    for (let vid of videos) {\n      if (vid.size > 100 * 1024 * 1024) {\n        setError(\"Video must be ≤ 100MB.\");\n        return;\n      }\n    }\n    setMediaFiles([...images, ...videos]);\n  }\n  function removeMedia(idx) {\n    setMediaFiles(mediaFiles.filter((_, i) => i !== idx));\n  }\n  function handleCaptionChange(e) {\n    setCaption(e.target.value);\n  }\n  async function post() {\n    setLoading(true);\n    setError(\"\");\n    // Check quota and time window for 0-followers\n    try {\n      const now = new Date();\n      const istNow = new Date(now.toLocaleString(\"en-US\", {\n        timeZone: \"Asia/Kolkata\"\n      }));\n      const hour = istNow.getHours();\n      const follows = ((user === null || user === void 0 ? void 0 : user.follows) || []).length;\n      if (follows === 0) {\n        // only 10:00 - 10:30 allowed\n        const minute = istNow.getMinutes();\n        if (!(hour === 10 && minute >= 0 && minute <= 30)) {\n          setError(\"Users who follow nobody can post only between 10:00-10:30 IST\");\n          setLoading(false);\n          return;\n        }\n      }\n      if (quotaInfo.remaining !== Infinity && quotaInfo.remaining <= 0) {\n        setError(\"You have reached your posting limit for today.\");\n        setLoading(false);\n        return;\n      }\n    } catch (e) {\n      // proceed\n    }\n    try {\n      var _res2$data$user, _res2$data$user2, _res2$data$user2$subs, _planMap$plan2, _res2$data$user3;\n      const fd = new FormData();\n      fd.append(\"text\", caption);\n      if (mediaFiles && mediaFiles.length) {\n        for (const f of mediaFiles) fd.append(\"media\", f);\n      }\n      const res = await API.post(\"/tweets\", fd);\n      // Show browser notification if backend signals notify or text contains keywords\n      try {\n        const shouldNotify = res.data && res.data.notify || caption && /(cricket|science)/i.test(caption);\n        if (notificationsEnabled && shouldNotify && typeof Notification !== \"undefined\" && Notification.permission === \"granted\") {\n          new Notification(\"New Tweet\", {\n            body: caption || \"New tweet posted\"\n          });\n        }\n      } catch (e) {\n        console.debug(\"Notification error\", e);\n      }\n      setCaption(\"\");\n      setMediaFiles([]);\n      onPosted && onPosted();\n      // refresh quota\n      const res2 = await API.get(\"/auth/me\");\n      const tweetsRes = await API.get(\"/tweets\");\n      const all = tweetsRes.data || [];\n      const myId = (_res2$data$user = res2.data.user) === null || _res2$data$user === void 0 ? void 0 : _res2$data$user._id;\n      const today = new Date();\n      const istToday = new Date(today.toLocaleString(\"en-US\", {\n        timeZone: \"Asia/Kolkata\"\n      }));\n      const start = new Date(istToday.getFullYear(), istToday.getMonth(), istToday.getDate(), 0, 0, 0);\n      const end = new Date(istToday.getFullYear(), istToday.getMonth(), istToday.getDate(), 23, 59, 59);\n      const used = all.filter(t => {\n        var _t$user2;\n        return ((_t$user2 = t.user) === null || _t$user2 === void 0 ? void 0 : _t$user2._id) === myId && new Date(t.createdAt) >= start && new Date(t.createdAt) <= end;\n      }).length;\n      const plan = ((_res2$data$user2 = res2.data.user) === null || _res2$data$user2 === void 0 ? void 0 : (_res2$data$user2$subs = _res2$data$user2.subscription) === null || _res2$data$user2$subs === void 0 ? void 0 : _res2$data$user2$subs.plan) || \"free\";\n      const planMap = {\n        free: 1,\n        bronze: 3,\n        silver: 5,\n        gold: Infinity\n      };\n      let allowed = (_planMap$plan2 = planMap[plan]) !== null && _planMap$plan2 !== void 0 ? _planMap$plan2 : 1;\n      const follows = (((_res2$data$user3 = res2.data.user) === null || _res2$data$user3 === void 0 ? void 0 : _res2$data$user3.follows) || []).length;\n      if (follows === 0) allowed = Math.min(allowed, 1);else if (follows >= 2 && follows <= 10) allowed = Math.min(allowed, 2);\n      const remaining = allowed === Infinity ? Infinity : Math.max(0, allowed - used);\n      setTodayCount(used);\n      setQuotaInfo({\n        allowed,\n        remaining,\n        reason: \"\"\n      });\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || err.message);\n    }\n    setLoading(false);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"composer bg-white rounded-xl shadow-lg p-4 flex flex-col gap-4 max-w-xl mx-auto\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: `border-2 ${dragActive ? \"border-blue-400 bg-blue-50\" : \"border-dashed border-gray-300\"} rounded-xl p-4 flex flex-col items-center justify-center cursor-pointer transition mb-2 relative`,\n      onClick: handleUploadClick,\n      onDrop: handleDrop,\n      onDragOver: handleDragOver,\n      onDragLeave: handleDragLeave,\n      style: {\n        minHeight: \"120px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        multiple: true,\n        accept: \"image/*,video/*\",\n        ref: fileInputRef,\n        style: {\n          display: \"none\"\n        },\n        onChange: handleFileChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        className: \"px-5 py-2 rounded-full bg-gradient-to-r from-blue-500 to-cyan-400 text-white font-bold shadow hover:scale-105 transition mb-2\",\n        children: \"Upload Media\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-gray-400 text-sm\",\n        children: \"Drag & drop images (max 4) or 1 video here\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-red-500 text-sm mb-2\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 17\n    }, this), mediaFiles.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-2\",\n      children: mediaFiles[0].type.startsWith(\"image\") ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"grid grid-cols-2 gap-3\",\n        children: mediaFiles.map((file, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative group\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: URL.createObjectURL(file),\n            alt: \"preview\",\n            className: \"rounded-lg shadow border border-gray-200 object-cover w-full h-32\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 236,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: e => {\n              e.stopPropagation();\n              removeMedia(idx);\n            },\n            className: \"absolute top-2 right-2 bg-white/80 rounded-full p-1 text-gray-700 hover:text-red-500 shadow group-hover:scale-110 transition\",\n            children: \"\\xD7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 241,\n            columnNumber: 19\n          }, this)]\n        }, idx, true, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 17\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative\",\n        children: [/*#__PURE__*/_jsxDEV(\"video\", {\n          src: URL.createObjectURL(mediaFiles[0]),\n          controls: true,\n          className: \"rounded-lg shadow border border-gray-200 w-full h-48 object-cover\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: e => {\n            e.stopPropagation();\n            removeMedia(0);\n          },\n          className: \"absolute top-2 right-2 bg-white/80 rounded-full p-1 text-gray-700 hover:text-red-500 shadow transition\",\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n      value: caption,\n      onChange: handleCaptionChange,\n      placeholder: \"Write a caption\\u2026\",\n      className: \"w-full rounded-2xl border border-gray-300 p-3 text-base focus:outline-none focus:ring-2 focus:ring-blue-300 resize-none mb-2\",\n      rows: 2\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 7\n    }, this), caption && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-2 text-base\",\n      children: highlightCaption(caption)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-sm text-gray-600 mb-2\",\n      children: quotaInfo.allowed === Infinity ? /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"Plan: Unlimited tweets\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n        children: [\"Today: \", todayCount, \"/\", quotaInfo.allowed, \" \\u2014 Remaining: \", quotaInfo.remaining]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: post,\n      disabled: loading || !caption.trim() && mediaFiles.length === 0 || quotaInfo.remaining !== Infinity && quotaInfo.remaining <= 0,\n      className: \"self-end px-6 py-2 rounded-full bg-gradient-to-r from-blue-500 to-cyan-400 text-white font-bold shadow hover:scale-105 transition flex items-center gap-2\",\n      children: [loading && /*#__PURE__*/_jsxDEV(\"svg\", {\n        className: \"animate-spin h-5 w-5 text-white\",\n        viewBox: \"0 0 24 24\",\n        children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n          className: \"opacity-25\",\n          cx: \"12\",\n          cy: \"12\",\n          r: \"10\",\n          stroke: \"currentColor\",\n          strokeWidth: \"4\",\n          fill: \"none\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          className: \"opacity-75\",\n          fill: \"currentColor\",\n          d: \"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 01-8 8z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 11\n      }, this), \"Tweet\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 203,\n    columnNumber: 5\n  }, this);\n}\n_s(PostComposer, \"QkPWieDMXdvFv7i7T2DQsYQ1cYg=\");\n_c = PostComposer;\nvar _c;\n$RefreshReg$(_c, \"PostComposer\");","map":{"version":3,"names":["React","useRef","useState","useEffect","useContext","API","NotificationContext","jsxDEV","_jsxDEV","highlightCaption","text","regex","parts","split","map","part","i","test","className","children","fileName","_jsxFileName","lineNumber","columnNumber","PostComposer","onPosted","_s","enabled","notificationsEnabled","caption","setCaption","mediaFiles","setMediaFiles","error","setError","loading","setLoading","fileInputRef","dragActive","setDragActive","user","setUser","todayCount","setTodayCount","quotaInfo","setQuotaInfo","allowed","remaining","reason","load","_u$subscription","_planMap$plan","res","get","u","data","tweetsRes","all","myId","_id","today","Date","istToday","toLocaleString","timeZone","start","getFullYear","getMonth","getDate","end","used","filter","t","_t$user","createdAt","length","plan","subscription","planMap","free","bronze","silver","gold","Infinity","allowedByPlan","follows","allowedByFollows","Math","max","e","handleUploadClick","current","click","handleFileChange","files","Array","from","target","validateAndSetFiles","handleDrop","preventDefault","dataTransfer","handleDragOver","handleDragLeave","images","f","type","startsWith","videos","img","size","vid","removeMedia","idx","_","handleCaptionChange","value","post","now","istNow","hour","getHours","minute","getMinutes","_res2$data$user","_res2$data$user2","_res2$data$user2$subs","_planMap$plan2","_res2$data$user3","fd","FormData","append","shouldNotify","notify","Notification","permission","body","console","debug","res2","_t$user2","min","err","_err$response","_err$response$data","response","message","onClick","onDrop","onDragOver","onDragLeave","style","minHeight","multiple","accept","ref","display","onChange","file","src","URL","createObjectURL","alt","stopPropagation","controls","placeholder","rows","disabled","trim","viewBox","cx","cy","r","stroke","strokeWidth","fill","d","_c","$RefreshReg$"],"sources":["C:/Users/itsmu/Downloads/twiller_complete_project/frontend/src/components/PostComposer.jsx"],"sourcesContent":["import React, { useRef, useState, useEffect, useContext } from \"react\";\nimport API from \"../api\";\nimport NotificationContext from \"../notificationContext\";\n\nfunction highlightCaption(text) {\n  // Highlight hashtags and @mentions in blue\n  const regex = /([#@][\\w]+)/g;\n  const parts = text.split(regex);\n  return parts.map((part, i) =>\n    regex.test(part)\n      ? <span key={i} className=\"text-blue-500 font-semibold\">{part}</span>\n      : part\n  );\n}\n\nexport default function PostComposer({ onPosted }) {\n  const { enabled: notificationsEnabled } = useContext(NotificationContext);\n  const [caption, setCaption] = useState(\"\");\n  const [mediaFiles, setMediaFiles] = useState([]); // Array of File\n  const [error, setError] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const fileInputRef = useRef();\n  const [dragActive, setDragActive] = useState(false);\n  const [user, setUser] = useState(null);\n  const [todayCount, setTodayCount] = useState(0);\n  const [quotaInfo, setQuotaInfo] = useState({ allowed: 1, remaining: 1, reason: \"\" });\n\n  useEffect(() => {\n    async function load() {\n      try {\n        const res = await API.get(\"/auth/me\");\n        const u = res.data.user;\n        setUser(u);\n        // fetch tweets and compute today's count\n        const tweetsRes = await API.get(\"/tweets\");\n        const all = tweetsRes.data || [];\n        const myId = u?._id;\n        const today = new Date();\n        const istToday = new Date(today.toLocaleString(\"en-US\", { timeZone: \"Asia/Kolkata\" }));\n        const start = new Date(istToday.getFullYear(), istToday.getMonth(), istToday.getDate(), 0, 0, 0);\n        const end = new Date(istToday.getFullYear(), istToday.getMonth(), istToday.getDate(), 23, 59, 59);\n        const used = all.filter(t => t.user?._id === myId && new Date(t.createdAt) >= start && new Date(t.createdAt) <= end).length;\n        setTodayCount(used);\n\n        // compute allowed posts by subscription\n        const plan = u?.subscription?.plan || \"free\";\n        const planMap = { free: 1, bronze: 3, silver: 5, gold: Infinity };\n        let allowedByPlan = planMap[plan] ?? 1;\n\n        // follow-based allowances\n        const follows = (u?.follows || []).length;\n        let allowedByFollows = 0;\n        if (follows === 0) {\n          allowedByFollows = 1; // limited to 1 but time-window enforced on post\n        } else if (follows === 2) {\n          allowedByFollows = 2;\n        } else if (follows > 10) {\n          allowedByFollows = Infinity;\n        }\n\n        const allowed = allowedByFollows === 0 ? allowedByPlan : Math.max(allowedByPlan, allowedByFollows);\n        const remaining = allowed === Infinity ? Infinity : Math.max(0, allowed - used);\n        setQuotaInfo({ allowed, remaining, reason: \"\" });\n      } catch (e) {\n        // ignore\n      }\n    }\n    load();\n  }, []);\n\n  function handleUploadClick() {\n    fileInputRef.current.click();\n  }\n\n  function handleFileChange(e) {\n    let files = Array.from(e.target.files);\n    validateAndSetFiles(files);\n  }\n\n  function handleDrop(e) {\n    e.preventDefault();\n    setDragActive(false);\n    let files = Array.from(e.dataTransfer.files);\n    validateAndSetFiles(files);\n  }\n\n  function handleDragOver(e) {\n    e.preventDefault();\n    setDragActive(true);\n  }\n\n  function handleDragLeave(e) {\n    e.preventDefault();\n    setDragActive(false);\n  }\n\n  function validateAndSetFiles(files) {\n    setError(\"\");\n    let images = files.filter(f => f.type.startsWith(\"image\"));\n    let videos = files.filter(f => f.type.startsWith(\"video\"));\n    if (videos.length > 1 || (videos.length && images.length)) {\n      setError(\"You can upload up to 4 images or 1 video only.\");\n      return;\n    }\n    if (images.length > 4) {\n      setError(\"Maximum 4 images allowed.\");\n      return;\n    }\n    for (let img of images) {\n      if (img.size > 5 * 1024 * 1024) {\n        setError(\"Each image must be ≤ 5MB.\");\n        return;\n      }\n    }\n    for (let vid of videos) {\n      if (vid.size > 100 * 1024 * 1024) {\n        setError(\"Video must be ≤ 100MB.\");\n        return;\n      }\n    }\n    setMediaFiles([...images, ...videos]);\n  }\n\n  function removeMedia(idx) {\n    setMediaFiles(mediaFiles.filter((_, i) => i !== idx));\n  }\n\n  function handleCaptionChange(e) {\n    setCaption(e.target.value);\n  }\n\n  async function post() {\n    setLoading(true);\n    setError(\"\");\n    // Check quota and time window for 0-followers\n    try {\n      const now = new Date();\n      const istNow = new Date(now.toLocaleString(\"en-US\", { timeZone: \"Asia/Kolkata\" }));\n      const hour = istNow.getHours();\n      const follows = (user?.follows || []).length;\n      if (follows === 0) {\n          // only 10:00 - 10:30 allowed\n          const minute = istNow.getMinutes();\n          if (!(hour === 10 && minute >= 0 && minute <= 30)) {\n          setError(\"Users who follow nobody can post only between 10:00-10:30 IST\");\n          setLoading(false);\n          return;\n        }\n      }\n      if (quotaInfo.remaining !== Infinity && quotaInfo.remaining <= 0) {\n        setError(\"You have reached your posting limit for today.\");\n        setLoading(false);\n        return;\n      }\n    } catch (e) {\n      // proceed\n    }\n    try {\n      const fd = new FormData();\n      fd.append(\"text\", caption);\n      if (mediaFiles && mediaFiles.length) {\n        for (const f of mediaFiles) fd.append(\"media\", f);\n      }\n      const res = await API.post(\"/tweets\", fd);\n      // Show browser notification if backend signals notify or text contains keywords\n      try {\n        const shouldNotify = (res.data && res.data.notify) || (caption && /(cricket|science)/i.test(caption));\n        if (notificationsEnabled && shouldNotify && typeof Notification !== \"undefined\" && Notification.permission === \"granted\") {\n          new Notification(\"New Tweet\", { body: caption || \"New tweet posted\" });\n        }\n      } catch (e) {\n        console.debug(\"Notification error\", e);\n      }\n      setCaption(\"\");\n      setMediaFiles([]);\n      onPosted && onPosted();\n      // refresh quota\n      const res2 = await API.get(\"/auth/me\");\n      const tweetsRes = await API.get(\"/tweets\");\n      const all = tweetsRes.data || [];\n      const myId = res2.data.user?._id;\n      const today = new Date();\n      const istToday = new Date(today.toLocaleString(\"en-US\", { timeZone: \"Asia/Kolkata\" }));\n      const start = new Date(istToday.getFullYear(), istToday.getMonth(), istToday.getDate(), 0, 0, 0);\n      const end = new Date(istToday.getFullYear(), istToday.getMonth(), istToday.getDate(), 23, 59, 59);\n      const used = all.filter(t => t.user?._id === myId && new Date(t.createdAt) >= start && new Date(t.createdAt) <= end).length;\n      const plan = res2.data.user?.subscription?.plan || \"free\";\n      const planMap = { free: 1, bronze: 3, silver: 5, gold: Infinity };\n      let allowed = planMap[plan] ?? 1;\n      const follows = (res2.data.user?.follows || []).length;\n      if (follows === 0) allowed = Math.min(allowed, 1);\n      else if (follows >= 2 && follows <= 10) allowed = Math.min(allowed, 2);\n      const remaining = allowed === Infinity ? Infinity : Math.max(0, allowed - used);\n      setTodayCount(used);\n      setQuotaInfo({ allowed, remaining, reason: \"\" });\n    } catch (err) {\n      setError(err.response?.data?.message || err.message);\n    }\n    setLoading(false);\n  }\n\n  return (\n    <div className=\"composer bg-white rounded-xl shadow-lg p-4 flex flex-col gap-4 max-w-xl mx-auto\">\n      <div\n        className={`border-2 ${dragActive ? \"border-blue-400 bg-blue-50\" : \"border-dashed border-gray-300\"} rounded-xl p-4 flex flex-col items-center justify-center cursor-pointer transition mb-2 relative`}\n        onClick={handleUploadClick}\n        onDrop={handleDrop}\n        onDragOver={handleDragOver}\n        onDragLeave={handleDragLeave}\n        style={{ minHeight: \"120px\" }}\n      >\n        <input\n          type=\"file\"\n          multiple\n          accept=\"image/*,video/*\"\n          ref={fileInputRef}\n          style={{ display: \"none\" }}\n          onChange={handleFileChange}\n        />\n        <button\n          type=\"button\"\n          className=\"px-5 py-2 rounded-full bg-gradient-to-r from-blue-500 to-cyan-400 text-white font-bold shadow hover:scale-105 transition mb-2\"\n        >\n          Upload Media\n        </button>\n        <span className=\"text-gray-400 text-sm\">Drag & drop images (max 4) or 1 video here</span>\n      </div>\n      {error && <div className=\"text-red-500 text-sm mb-2\">{error}</div>}\n      {mediaFiles.length > 0 && (\n        <div className=\"mb-2\">\n          {/* Image grid or video preview */}\n          {mediaFiles[0].type.startsWith(\"image\") ? (\n            <div className=\"grid grid-cols-2 gap-3\">\n              {mediaFiles.map((file, idx) => (\n                <div key={idx} className=\"relative group\">\n                  <img\n                    src={URL.createObjectURL(file)}\n                    alt=\"preview\"\n                    className=\"rounded-lg shadow border border-gray-200 object-cover w-full h-32\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={e => { e.stopPropagation(); removeMedia(idx); }}\n                    className=\"absolute top-2 right-2 bg-white/80 rounded-full p-1 text-gray-700 hover:text-red-500 shadow group-hover:scale-110 transition\"\n                  >\n                    ×\n                  </button>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"relative\">\n              <video\n                src={URL.createObjectURL(mediaFiles[0])}\n                controls\n                className=\"rounded-lg shadow border border-gray-200 w-full h-48 object-cover\"\n              />\n              <button\n                type=\"button\"\n                onClick={e => { e.stopPropagation(); removeMedia(0); }}\n                className=\"absolute top-2 right-2 bg-white/80 rounded-full p-1 text-gray-700 hover:text-red-500 shadow transition\"\n              >\n                ×\n              </button>\n            </div>\n          )}\n        </div>\n      )}\n      <textarea\n        value={caption}\n        onChange={handleCaptionChange}\n        placeholder=\"Write a caption…\"\n        className=\"w-full rounded-2xl border border-gray-300 p-3 text-base focus:outline-none focus:ring-2 focus:ring-blue-300 resize-none mb-2\"\n        rows={2}\n      ></textarea>\n      {/* Hashtag/@mention highlight preview */}\n      {caption && (\n        <div className=\"mb-2 text-base\">\n          {highlightCaption(caption)}\n        </div>\n      )}\n      {/* Quota display */}\n      <div className=\"text-sm text-gray-600 mb-2\">\n        {quotaInfo.allowed === Infinity ? (\n          <span>Plan: Unlimited tweets</span>\n        ) : (\n          <span>Today: {todayCount}/{quotaInfo.allowed} &mdash; Remaining: {quotaInfo.remaining}</span>\n        )}\n      </div>\n      <button\n        onClick={post}\n        disabled={\n          loading ||\n          (!caption.trim() && mediaFiles.length === 0) ||\n          (quotaInfo.remaining !== Infinity && quotaInfo.remaining <= 0)\n        }\n        className=\"self-end px-6 py-2 rounded-full bg-gradient-to-r from-blue-500 to-cyan-400 text-white font-bold shadow hover:scale-105 transition flex items-center gap-2\"\n      >\n        {loading && (\n          <svg className=\"animate-spin h-5 w-5 text-white\" viewBox=\"0 0 24 24\">\n            <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />\n            <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8v4l3-3-3-3v4a8 8 0 01-8 8z\" />\n          </svg>\n        )}\n        Tweet\n      </button>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}